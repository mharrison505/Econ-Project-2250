---
title: "Econ Final Presentation"
format: revealjs
editor: visual
---

## Quarto

Quarto enables you to weave together content and executable code into a finished presentation. To learn more about Quarto presentations see <https://quarto.org/docs/presentations/>.

## Bullets

When you click the **Render** button a document will be generated that includes:

-   Content authored with markdown
-   Output from executable code

## Code

When you click the **Render** button, a presentation will be generated that includes both content and the output of embedded code. You can embed code like this:

```{r}
1 + 2

1+3+4

1 + 2 + 3

hi=2
print(hi)

1+1
```

```{r}
#Im testing to see if it works

knitr::opts_chunk$set(warning = FALSE, message = FALSE)
if (!require("pacman")) install.packages("pacman")
pacman::p_load(
tidyverse,
probstats4econ,
kableExtra,
RColorBrewer,
curl,
usethis,
ggrepel)

#X2022WITHWINS%>%glimpse()

```

```{r}
#all the 2022 stats, wins v PA
plot(X2022WITHWINS$Wins, X2022WITHWINS$PA,xlab="Wins",ylab="Points Allowed")

text(X2022WITHWINS$Wins,
     X2022WITHWINS$PA,
     labels = X2022WITHWINS$Tm,   
     pos = 3,                       
     cex = 0.3)  

library(ggplot2)
library(ggrepel)

ggplot(X2022WITHWINS, aes(x = Wins, y = PA, label = Tm)) +
  geom_point(size = 3) +                       
  ggrepel::geom_text_repel(size = 3) +          
  labs(x = "Wins", y = "Points Allowed", title = "NFL 2022 Wins vs Points Allowed") +
  theme_minimal()


model <- lm(PA ~ Wins, data = X2022WITHWINS)

abline(model, col = "green", lwd = 2)

eq <- paste0("y = ",
             round(coef(model)[2], 2),
             "x + ",
             round(coef(model)[1], 2))

text(x = max(X2022WITHWINS$Wins),
     y = min(X2022WITHWINS$PA),
     labels = eq,
     pos = 4)

### Wins v RY/G
plot(X2022WITHWINS$Wins, X2022WITHWINS$`RY/G`,xlab="Wins",ylab="Rushing/Game")

text(X2022WITHWINS$Wins,
     X2022WITHWINS$`RY/G`,
     labels = X2022WITHWINS$Tm,   
     pos = 3,                       
     cex = 0.3)  
ggplot(X2022WITHWINS, aes(x = Wins, y = `RY/G`, label = Tm)) +
  geom_point(size = 3) +                       
  ggrepel::geom_text_repel(size = 3) +          
  labs(x = "Wins", y = "Rushing Yards Per Game", title = "NFL 2022 Wins vs Rushing Yards Per Game") +
  theme_minimal()


model <- lm(`RY/G` ~ Wins, data = X2022WITHWINS)

abline(model, col = "green", lwd = 2)

eq <- paste0("y = ",
             round(coef(model)[2], 2),
             "x + ",
             round(coef(model)[1], 2))

text(x = max(X2022WITHWINS$Wins),
     y = min(X2022WITHWINS$`RY/G`),
     labels = eq,
     pos = 4)

### Wins V PY/G
plot(X2022WITHWINS$Wins, X2022WITHWINS$`PY/G`,xlab="Wins",ylab="Passing/Game")

text(X2022WITHWINS$Wins,
     X2022WITHWINS$`PY/G`,
     labels = X2022WITHWINS$Tm,   
     pos = 3,                       
     cex = 0.3)  
ggplot(X2022WITHWINS, aes(x = Wins, y = `PY/G`, label = Tm)) +
  geom_point(size = 3) +                       
  ggrepel::geom_text_repel(size = 3) +          
  labs(x = "Wins", y = "Passing Yards Per Game", title = "NFL 2022 Wins vs Passing Yards Per Game") +
  theme_minimal()


model <- lm(`PY/G` ~ Wins, data = X2022WITHWINS)

abline(model, col = "green", lwd = 2)

eq <- paste0("y = ",
             round(coef(model)[2], 2),
             "x + ",
             round(coef(model)[1], 2))

text(x = max(X2022WITHWINS$Wins),
     y = min(X2022WITHWINS$`PY/G`),
     labels = eq,
     pos = 4)

# Wins V Pts For
plot(X2022WITHWINS$Wins, X2022WITHWINS$`Pts For`,xlab="Wins",ylab="Pts/G")

text(X2022WITHWINS$Wins,
     X2022WITHWINS$`Pts For`,
     labels = X2022WITHWINS$Tm,   
     pos = 3,                       
     cex = 0.3)  
ggplot(X2022WITHWINS, aes(x = Wins, y = `Pts For`, label = Tm)) +
  geom_point(size = 3) +                       
  ggrepel::geom_text_repel(size = 3) +          
  labs(x = "Wins", y = "Points Scored Per Game", title = "NFL 2022 Wins vs Points Scored Per Game") +
  theme_minimal()


model <- lm(`Pts For` ~ Wins, data = X2022WITHWINS)

abline(model, col = "green", lwd = 2)

eq <- paste0("y = ",
             round(coef(model)[2], 2),
             "x + ",
             round(coef(model)[1], 2))

text(x = max(X2022WITHWINS$Wins),
     y = min(X2022WITHWINS$`Pts For`),
     labels = eq,
     pos = 4)

###Wins v PYA

plot(X2022WITHWINS$Wins, X2022WITHWINS$PYdsA,xlab="Wins",ylab="Passing/Game")

text(X2022WITHWINS$Wins,
     X2022WITHWINS$PYdsA,
     labels = X2022WITHWINS$Tm,   
     pos = 3,                       
     cex = 0.3)  
ggplot(X2022WITHWINS, aes(x = Wins, y = PYdsA, label = Tm)) +
  geom_point(size = 3) +                       
  ggrepel::geom_text_repel(size = 3) +          
  labs(x = "Wins", y = "Passing Yards Allowed Per Game", title = "NFL 2022 Wins vs Passing Yards Allowed Per Game") +
  theme_minimal()


model <- lm(PYdsA ~ Wins, data = X2022WITHWINS)

abline(model, col = "green", lwd = 2)

eq <- paste0("y = ",
             round(coef(model)[2], 2),
             "x + ",
             round(coef(model)[1], 2))

text(x = max(X2022WITHWINS$Wins),
     y = min(X2022WITHWINS$PYdsA),
     labels = eq,
     pos = 4)

##Wins v RYA

plot(X2022WITHWINS$Wins, X2022WITHWINS$RYdsA,xlab="Wins",ylab="RYA/Game")

text(X2022WITHWINS$Wins,
     X2022WITHWINS$RYdsA,
     labels = X2022WITHWINS$Tm,   
     pos = 3,                       
     cex = 0.3)  
ggplot(X2022WITHWINS, aes(x = Wins, y = `PY/G`, label = Tm)) +
  geom_point(size = 3) +                       
  ggrepel::geom_text_repel(size = 3) +          
  labs(x = "Wins", y = "Rushing Yards Allowed Per Game", title = "NFL 2022 Wins vs Rushing Yards Allowed Per Game") +
  theme_minimal()


model <- lm(RYdsA ~ Wins, data = X2022WITHWINS)

abline(model, col = "green", lwd = 2)

eq <- paste0("y = ",
             round(coef(model)[2], 2),
             "x + ",
             round(coef(model)[1], 2))

text(x = max(X2022WITHWINS$Wins),
     y = min(X2022WITHWINS$RYdsA),
     labels = eq,
     pos = 4)
```

\`\`\`{# 0. Environment Setup (Run this first!)} \# Run these two lines only once if you haven't installed the packages yet: \# install.packages("ggplot2") \# install.packages("dplyr") rm(list=ls()) \# Clears your environment to prevent conflicts library(ggplot2) library(dplyr)

# 1. Data Creation: Define vectors first, then combine into a data frame

Teams \<- c("Baltimore Ravens", "Minnesota Vikings", "Denver Broncos", "Tampa Bay Buccaneers", "Detroit Lions", "Pittsburgh Steelers", "Green Bay Packers", "Kansas City Chiefs", "Miami Dolphins", "Philadelphia Eagles", "Houston Texans", "Buffalo Bills", "Las Vegas Raiders", "Los Angeles Chargers", "Atlanta Falcons", "Seattle Seahawks", "New York Jets", "San Francisco 49ers", "Cincinnati Bengals", "Arizona Cardinals", "Cleveland Browns", "Los Angeles Rams", "New England Patriots", "Indianapolis Colts", "Jacksonville Jaguars", "Tennessee Titans", "New York Giants", "Chicago Bears", "Dallas Cowboys", "Washington Commanders", "New Orleans Saints", "Carolina Panthers")

Off_Rush_Yards_G \<- c(80.1, 93.4, 96.4, 97.8, 98.4, 98.7, 99.4, 101.8, 103.7, 104.2, 114.0, 115.5, 116.9, 117.5, 120.6, 120.8, 121.1, 124.6, 124.8, 126.4, 129.7, 130.0, 131.4, 131.8, 132.6, 133.9, 136.2, 136.3, 137.1, 137.5, 141.4, 179.8) Off_Pass_Yards_G \<- c(237.4, 237.8, 212.4, 250.4, 263.2, 192.0, 223.9, 222.4, 219.8, 187.9, 207.4, 227.9, 223.4, 213.5, 239.3, 236.5, 218.5, 249.1, 272.9, 214.1, 206.2, 227.5, 176.2, 197.7, 204.5, 195.1, 189.9, 181.5, 227.2, 215.6, 205.2, 187.5) Off_Pts_G \<- c(30.5, 25.4, 25.0, 29.5, 33.2, 22.4, 27.1, 22.6, 20.3, 27.2, 21.9, 30.9, 18.2, 23.6, 22.9, 22.1, 19.9, 22.9, 27.8, 23.5, 15.2, 21.6, 17.0, 22.2, 18.8, 18.3, 16.1, 18.2, 20.6, 28.5, 19.9, 20.1) Def_Pass_Yards_Allowed_G \<- c(244.1, 242.0, 220.7, 243.9, 244.0, 228.0, 215.2, 218.8, 210.7, 174.2, 201.0, 226.1, 216.2, 206.9, 224.5, 211.9, 192.6, 192.8, 223.5, 216.1, 212.4, 223.1, 211.5, 229.4, 257.4, 177.3, 210.6, 217.9, 218.1, 189.5, 238.5, 224.7) Def_PA_G \<- c(21.2, 19.5, 18.3, 22.6, 20.1, 20.4, 19.9, 19.2, 21.4, 17.8, 21.9, 21.6, 25.5, 17.7, 24.9, 21.6, 23.8, 25.6, 25.5, 22.3, 25.6, 22.7, 24.5, 25.1, 25.6, 27.1, 24.4, 21.8, 27.5, 23.0, 23.4, 31.4) Off_Rush_Yards_G_Total \<- c(187.6, 109.1, 112.2, 149.2, 146.4, 127.4, 146.8, 105.3, 105.6, 179.3, 112.3, 131.2, 79.8, 110.7, 130.5, 95.7, 91.8, 127.2, 92.6, 144.2, 94.6, 103.8, 115.8, 137.1, 101.7, 109.1, 104.9, 102.0, 100.3, 154.1, 114.9, 110.5) Wins \<- c(12, 14, 10, 10, 15, 10, 11, 15, 8, 14, 10, 13, 4, 11, 8, 10, 5, 6, 9, 8, 3, 10, 4, 8, 4, 3, 3, 5, 7, 12, 5, 5)

# Combine into the final data frame, using Teams as row names

nfl_stats \<- data.frame( Off_Rush_Yards_G, Off_Pass_Yards_G, Off_Pts_G, Def_Pass_Yards_Allowed_G, Def_PA_G, Off_Rush_Yards_G_Total, Wins, row.names = Teams )

# 2. Define the statistics to correlate with Wins

stat_cols \<- c( "Off_Rush_Yards_G", "Off_Pass_Yards_G", "Off_Pts_G", "Def_Pass_Yards_Allowed_G", "Def_PA_G", "Off_Rush_Yards_G_Total" )

# Initialize a data frame to store the R-squared and R values

results_df \<- data.frame( Statistic = character(), r_value = numeric(), r_squared = numeric(), stringsAsFactors = FALSE )

# 3. Loop through the statistics, calculate correlation, and generate graphs

for (stat in stat_cols) { \# Calculate the Linear Model formula \<- as.formula(paste("Wins \~", stat)) model \<- lm(formula, data = nfl_stats)

```         

```

}

# 4. Print all R and R-squared values

print(results_df)

```         
```

```{}
```

```{r}
library(readxl)
library(dplyr)
library(ggplot2)

# Read Excel
stats <- read_excel("All stats 2024.xlsx")

# Define the 32 NFL teams
teams <- c(
  "Baltimore Ravens","Minnesota Vikings","Denver Broncos","Tampa Bay Buccaneers","Detroit Lions",
  "Pittsburgh Steelers","Green Bay Packers","Kansas City Chiefs","Miami Dolphins","Philadelphia Eagles",
  "Houston Texans","Buffalo Bills","Las Vegas Raiders","Los Angeles Chargers","Atlanta Falcons",
  "Seattle Seahawks","New York Jets","San Francisco 49ers","Cincinnati Bengals","Arizona Cardinals",
  "Cleveland Browns","Los Angeles Rams","New England Patriots","Indianapolis Colts","Jacksonville Jaguars",
  "Tennessee Titans","New York Giants","Chicago Bears","Dallas Cowboys","Washington Commanders",
  "New Orleans Saints","Carolina Panthers"
)

# Keep only rows that match real team names
stats_clean <- stats %>% filter(Tm...2 %in% teams)

# Add Wins in the same order as the rows in your file
stats_clean$Wins <- c(
  13, 7, 8, 9, 12, 10, 11, 11, 11, 11, 11, 11, 7, 6, 7, 9,
  6, 12, 9, 4, 11, 9, 4, 9, 9, 6, 6, 9, 12, 4, 9, 2
)

# Convert stat columns to numeric
stats_clean <- stats_clean %>%
  mutate(across(c(`Rush YdA/G`, `Pass Y/G`, `Pts/G`, `Pass YdA/G`, `PA/G`, `Rush Y/G`), as.numeric))

# Wins vs Rush YdA/G
r <- cor(stats_clean$Wins, stats_clean$`Rush YdA/G`); r2 <- r^2
ggplot(stats_clean, aes(x=`Rush YdA/G`, y=Wins)) +
  geom_point() + geom_smooth(method="lm", se=FALSE, color="red") +
  labs(title="Wins vs Rush YdA/G", subtitle=paste("r =", round(r,3), " r^2 =", round(r2,3)))

# Wins vs Pass Y/G
r <- cor(stats_clean$Wins, stats_clean$`Pass Y/G`); r2 <- r^2
ggplot(stats_clean, aes(x=`Pass Y/G`, y=Wins)) +
  geom_point() + geom_smooth(method="lm", se=FALSE, color="red") +
  labs(title="Wins vs Pass Y/G", subtitle=paste("r =", round(r,3), " r^2 =", round(r2,3)))

# Wins vs Pts/G
r <- cor(stats_clean$Wins, stats_clean$`Pts/G`); r2 <- r^2
ggplot(stats_clean, aes(x=`Pts/G`, y=Wins)) +
  geom_point() + geom_smooth(method="lm", se=FALSE, color="red") +
  labs(title="Wins vs Pts/G", subtitle=paste("r =", round(r,3), " r^2 =", round(r2,3)))

# Wins vs Pass YdA/G
r <- cor(stats_clean$Wins, stats_clean$`Pass YdA/G`); r2 <- r^2
ggplot(stats_clean, aes(x=`Pass YdA/G`, y=Wins)) +
  geom_point() + geom_smooth(method="lm", se=FALSE, color="red") +
  labs(title="Wins vs Pass YdA/G", subtitle=paste("r =", round(r,3), " r^2 =", round(r2,3)))

# Wins vs PA/G
r <- cor(stats_clean$Wins, stats_clean$`PA/G`); r2 <- r^2
ggplot(stats_clean, aes(x=`PA/G`, y=Wins)) +
  geom_point() + geom_smooth(method="lm", se=FALSE, color="red") +
  labs(title="Wins vs PA/G", subtitle=paste("r =", round(r,3), " r^2 =", round(r2,3)))

# Wins vs Rush Y/G
r <- cor(stats_clean$Wins, stats_clean$`Rush Y/G`); r2 <- r^2
ggplot(stats_clean, aes(x=`Rush Y/G`, y=Wins)) +
  geom_point() + geom_smooth(method="lm", se=FALSE, color="red") +
  labs(title="Wins vs Rush Y/G", subtitle=paste("r =", round(r,3), " r^2 =", round(r2,3)))

```
